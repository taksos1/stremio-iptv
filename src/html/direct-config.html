<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Direct Playlist Configuration • IPTV Addon</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="dark light">
    <link rel="stylesheet" href="/src/css/styles.css">
</head>
<body class="page-config">
<header class="site-header">
    <div class="inner">
        <h1 class="app-title">Direct M3U / EPG</h1>
        <p class="subtitle">Use a direct playlist URL and optional XMLTV guide.</p>
        <nav class="top-nav">
            <a href="/" class="nav-link">Home</a>
            <a href="/src/html/xtream-config.html" class="nav-link">Xtream Mode</a>
        </nav>
    </div>
</header>

<main class="main-content narrow">
    <form id="directForm" class="config-form" autocomplete="off">
        <fieldset>
            <legend>Playlist Source</legend>
            <div class="form-group">
                <label for="m3uUrl">M3U Playlist URL <span class="req">*</span></label>
                <input type="url" id="m3uUrl" name="m3uUrl" required placeholder="https://example.com/playlist.m3u">
                <small class="hint">HTTP(S) only. If the playlist requires credentials include them in the URL or use Xtream mode.</small>
            </div>
        </fieldset>

        <fieldset>
            <legend>EPG (Guide)</legend>
            <div class="form-group checkbox-line">
                <input type="checkbox" id="enableEpg" name="enableEpg" checked>
                <label for="enableEpg" class="inline">Enable EPG</label>
            </div>
            <div class="form-group">
                <label for="epgUrl">EPG XML URL (optional)</label>
                <input type="url" id="epgUrl" name="epgUrl" placeholder="https://example.com/guide.xml">
            </div>
            <div class="form-group">
                <label for="epgOffsetHours">EPG Offset (hours)</label>
                <input type="number" step="0.25" id="epgOffsetHours" name="epgOffsetHours" placeholder="0">
                <small class="hint">Shift programme times forward/backward (e.g. -1, 2, 0.5).</small>
            </div>
        </fieldset>

        <fieldset>
            <legend>Diagnostics</legend>
            <div class="form-group checkbox-line">
                <input type="checkbox" id="debugMode" name="debugMode">
                <label for="debugMode" class="inline">Enable Debug Logging</label>
            </div>
        </fieldset>

        <div class="form-actions">
            <button type="submit" class="btn primary wide">Install / Update (Direct)</button>
            <a href="/src/html/xtream-config.html" class="btn subtle">Switch to Xtream</a>
        </div>
        <div class="donate-inline under-form">
            <p class="hint" style="margin:.4rem 0 .6rem;">Enjoying the addon? Support development:</p>
            <script type="text/javascript"
                    src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js"
                    data-name="bmc-button"
                    data-slug="K3QSoR2"
                    data-color="#BD5FFF"
                    data-emoji="☕"
                    data-font="Cookie"
                    data-text="Buy me a coffee"
                    data-outline-color="#000000"
                    data-font-color="#ffffff"
                    data-coffee-color="#FFDD00">
            </script>
        </div>
    </form>

    <section class="info-panel">
        <h3>Process Overview</h3>
        <ol class="steps">
            <li>Playlist download & validation</li>
            <li>Local parsing and stats</li>
            <li>Optional EPG scan (non-fatal)</li>
            <li>Token generation</li>
            <li>Server manifest build & polling</li>
        </ol>
    </section>
</main>

<footer class="site-footer">
    <div class="inner">
        <p>&copy; 2025 M3U/EPG Addon • Made with ❤️ by Inside4ndroid • Direct Mode</p>
    </div>
</footer>

<div id="loaderOverlay" class="overlay hidden">
    <div class="overlay-box">
        <header class="overlay-header">
            <h2 id="loaderMessage">Starting…</h2>
            <p class="overlay-sub" id="progressText">0%</p>
        </header>
        <div class="progress-track"><div id="progressBar" class="progress-fill" style="width:0%"></div></div>
        <pre id="statusDetails" class="status-log" aria-live="polite"></pre>
        <div class="overlay-actions">
            <button id="openStremioBtn" class="btn success" disabled>Open in Stremio</button>
            <button id="copyManifestBtn" class="btn secondary" disabled>Copy Manifest URL</button>
        </div>
    </div>
</div>

<script src="/src/js/configure-common.js"></script>
<script src="/src/js/direct-config.js"></script>
</body>
</html>